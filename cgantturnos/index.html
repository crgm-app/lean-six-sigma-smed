<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>SMED Full Data Dashboard - 9 Comparativas Multidimensionales</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body { font-family: 'Segoe UI', Tahoma, sans-serif; background: #eceff1; margin: 0; padding: 20px; font-size: 12px; color: #2c3e50; }
        .container { max-width: 1600px; margin: auto; }
        .turno-section { background: #37474f; color: white; padding: 20px; border-radius: 8px; margin: 50px 0 20px 0; text-align: center; font-size: 2em; box-shadow: 0 4px 6px rgba(0,0,0,0.3); }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 25px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 20px rgba(0,0,0,0.08); border-top: 6px solid; overflow-x: auto; }
        .border-INT { border-color: #0288d1; }
        .border-EXT { border-color: #43a047; }
        .border-NVA { border-color: #d32f2f; }
        h2 { margin-top: 0; color: #455a64; font-size: 1.4em; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        
        table { width: 100%; border-collapse: collapse; margin-top: 15px; background: #fff; }
        th { background: #f8f9fa; color: #37474f; padding: 8px; font-weight: 600; border: 1px solid #cfd8dc; font-size: 10px; text-transform: uppercase; }
        td { padding: 8px; border: 1px solid #eceff1; text-align: center; }
        .text-left { text-align: left; font-weight: bold; background: #fafafa; }
        
        /* Formato Six Sigma */
        .q1-gold { background: #fff9c4; font-weight: bold; color: #f57f17; border: 1px solid #fbc02d; }
        .cv-excelente { color: #2e7d32; font-weight: bold; }
        .cv-alerta { color: #f57f17; font-weight: bold; }
        .cv-critico { color: #c62828; font-weight: bold; }
        
        .chart-box { height: 300px; margin-bottom: 20px; position: relative; }
        .badge { display: inline-block; padding: 3px 10px; border-radius: 20px; color: white; font-size: 0.7em; float: right; }
    </style>
</head>
<body>

<div class="container">
    <h1 style="text-align:center; font-size: 2.5em; margin-bottom: 5px;">Dashboard SMED <span style="color:#0288d1">Advanced Analytics</span></h1>
    <p style="text-align:center; color:#78909c; font-size: 1.2em;">Análisis completo de 1,912 mediciones - Corrugadoras e Imprentas</p>

    <div id="main-dashboard"></div>
</div>

<script>
// DATOS COMPLETOS PROCESADOS DEL CSV (Inyección dinámica)
const smedFullData = JSON.parse('<INSERT_JSON_DATA_HERE>');

const typeConfig = {
    'INT': { label: 'INTERNAS (Paro)', color: 'rgba(2, 136, 209, 0.8)', badge: 'REDUCIR' },
    'EXT': { label: 'EXTERNAS (Preparación)', color: 'rgba(67, 160, 71, 0.8)', badge: 'ESTANDARIZAR' },
    'NVA': { label: 'MUDAS (Desperdicio)', color: 'rgba(211, 47, 47, 0.8)', badge: 'ELIMINAR' }
};

const dashboard = document.getElementById('main-dashboard');

['T1', 'T2', 'T3'].forEach(turno => {
    // Título del Turno
    const tSection = document.createElement('div');
    tSection.className = 'turno-section';
    tSection.innerText = `ANÁLISIS ESTRATÉGICO: TURNO ${turno}`;
    dashboard.appendChild(tSection);

    const grid = document.createElement('div');
    grid.className = 'grid';

    ['INT', 'EXT', 'NVA'].forEach(tipo => {
        const activities = smedFullData[turno][tipo] || [];
        if (activities.length === 0) return;

        const card = document.createElement('div');
        card.className = `card border-${tipo}`;
        
        // Generar filas de la tabla con lógica Six Sigma
        const rows = activities.map(d => {
            const cvStatus = d.CV < 0.3 ? 'cv-excelente' : (d.CV < 0.6 ? 'cv-alerta' : 'cv-critico');
            return `
                <tr>
                    <td class="text-left">${d.Actividad}</td>
                    <td>${d.Min}s</td>
                    <td class="q1-gold">${d.Q1}s</td>
                    <td>${d.Med}s</td>
                    <td>${d.Q3}s</td>
                    <td>${d.Max}s</td>
                    <td style="color:#90a4ae">±${d.Std}s</td>
                    <td class="${cvStatus}">${(d.CV * 100).toFixed(1)}%</td>
                </tr>`;
        }).join('');

        card.innerHTML = `
            <h2>${typeConfig[tipo].label} <span class="badge" style="background:${typeConfig[tipo].color}">${typeConfig[tipo].badge}</span></h2>
            <div class="chart-box"><canvas id="chart_${turno}_${tipo}"></canvas></div>
            <table>
                <thead>
                    <tr>
                        <th rowspan="2">Actividad</th>
                        <th colspan="5">Distribución de Tiempos (Cuartiles)</th>
                        <th colspan="2">Six Sigma</th>
                    </tr>
                    <tr>
                        <th>Min</th><th class="q1-gold">Q1 (Gold)</th><th>Mediana</th><th>Q3</th><th>Max</th>
                        <th>Desv. (σ)</th><th>CV%</th>
                    </tr>
                </thead>
                <tbody>${rows}</tbody>
            </table>
        `;
        grid.appendChild(card);

        // Crear gráfico
        setTimeout(() => {
            new Chart(document.getElementById(`chart_${turno}_${tipo}`), {
                type: 'bar',
                data: {
                    labels: activities.slice(0, 10).map(a => a.Actividad),
                    datasets: [{
                        label: 'Impacto Total (Segundos)',
                        data: activities.slice(0, 10).map(a => a.Total),
                        backgroundColor: typeConfig[tipo].color,
                        borderRadius: 5
                    }]
                },
                options: {
                    indexAxis: 'y',
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: { x: { grid: { display: false } }, y: { grid: { display: false } } }
                }
            });
        }, 0);
    });
    dashboard.appendChild(grid);
});
</script>
</body>
</html>
