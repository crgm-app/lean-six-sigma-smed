<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>SMED Analyzer Pro - Lean Manufacturing</title>
    
    <!-- PWA Meta Tags -->
    <meta name="description" content="Cron√≥metro Industrial + An√°lisis Lean Manufacturing + Six Sigma">
    <meta name="theme-color" content="#00ff9d">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="SMED Pro">
    <meta name="mobile-web-app-capable" content="yes">
    
    <!-- Manifest y Iconos -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/svg+xml" href="icons/icon.svg">
    <link rel="apple-touch-icon" href="icons/icon-192.png">
    
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="app-container">
        <!-- HEADER -->
        <header class="app-header">
            <h1>üè≠ SMED Analyzer Pro</h1>
            <p>Cron√≥metro Industrial + An√°lisis Lean Manufacturing + Six Sigma</p>
        </header>

        <!-- NAVEGACI√ìN TABS -->
        <nav class="tab-nav">
            <button class="tab-btn active" data-tab="clock">‚è±Ô∏è Reloj</button>
            <button class="tab-btn" data-tab="analysis">üìä An√°lisis</button>
            <button class="tab-btn" data-tab="gantt">üìà Gantt</button>
            <button class="tab-btn" data-tab="stats">üìâ Estad√≠stica</button>
            <button class="tab-btn" data-tab="reports">üìÑ Informes</button>
            <button class="tab-btn" data-tab="theory">üìö Teor√≠a</button>
            <button class="tab-btn" data-tab="config">‚öôÔ∏è Config</button>
        </nav>

        <!-- ============================================== -->
        <!-- TAB: RELOJ / CRON√ìMETRO -->
        <!-- ============================================== -->
        <section id="tab-clock" class="view-section active">
            <div class="card">
                <!-- Reloj Maestro -->
                <div class="master-clock">
                    <div class="seconds-display" id="masterSeconds">00000.0</div>
                    <div class="time-display" id="masterTime">00:00:00</div>
                </div>

                <!-- Panel de Timers Activos -->
                <div id="activeTimersPanel" class="active-timers-panel hidden">
                    <h3>‚è±Ô∏è ACTIVIDAD EN CURSO:</h3>
                    <div id="activeTimersList"></div>
                </div>

                <!-- Panel de OP (Orden de Producci√≥n) Activa -->
                <div class="op-panel" style="background: linear-gradient(135deg, #1a1a2e, #0f0f1a); border: 1px solid #333; border-radius: 8px; padding: 12px; margin-bottom: 15px;">
                    <div style="display: flex; gap: 10px; align-items: flex-end; flex-wrap: wrap;">
                        <div style="flex: 2; min-width: 140px;">
                            <label style="font-size: 10px; color: #888; text-transform: uppercase;">üìã Orden de Producci√≥n</label>
                            <input type="text" id="opNumero" placeholder="Ej: 40005000" maxlength="8"
                                   style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00ff9d; font-size: 14px; font-weight: bold;"
                                   oninput="AppState.opActiva.numero = this.value; UI.renderButtons();">
                        </div>
                        <div style="flex: 1; min-width: 70px;">
                            <label style="font-size: 10px; color: #888; text-transform: uppercase;">üé® Colores</label>
                            <input type="number" id="opColores" min="1" max="10" value="1"
                                   style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 14px; text-align: center;"
                                   oninput="AppState.opActiva.colores = parseInt(this.value) || 1">
                        </div>
                        <div style="flex: 1; min-width: 90px;">
                            <label style="font-size: 10px; color: #888; text-transform: uppercase;">‚è∞ Turno</label>
                            <select id="opTurno" 
                                    style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #f59e0b; font-size: 14px; font-weight: bold;"
                                    onchange="AppState.opActiva.turno = this.value">
                                <option value="T1">T1 (6-14h)</option>
                                <option value="T2">T2 (14-21h)</option>
                                <option value="T3">T3 (21-6h)</option>
                            </select>
                        </div>
                        <div style="flex: 1; min-width: 80px;">
                            <label style="font-size: 10px; color: #888; text-transform: uppercase;">üè≠ M√°quina</label>
                            <select id="opMaquina" 
                                    style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 14px; font-weight: bold;"
                                    onchange="AppState.opActiva.maquina = this.value">
                                <option value="">--</option>
                                <option value="i4">i4</option>
                                <option value="i5">i5</option>
                                <option value="i6">i6</option>
                                <option value="i8">i8</option>
                                <option value="i10">i10</option>
                                <option value="i11">i11</option>
                                <option value="i12">i12</option>
                                <option value="i13">i13</option>
                                <option value="i14">i14</option>
                                <option value="i15">i15</option>
                                <option value="i16">i16</option>
                                <option value="i17">i17</option>
                            </select>
                        </div>
                        <div style="flex: 0; min-width: 90px;">
                            <div id="opStatus" style="padding: 8px 12px; border-radius: 4px; font-size: 11px; background: #333; text-align: center; color: #888;">
                                Sin OP activa
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Grid de Botones SMED -->
                <h2>Actividades SMED</h2>
                <div id="buttonsGrid" class="btn-grid"></div>

                <!-- M√öLTIPLES Cron√≥metros Libres -->
                <div style="margin: 15px 0; padding: 15px; background: linear-gradient(135deg, #2d1f5c, #1a1a2e); border: 2px dashed #8b5cf6; border-radius: 8px;">
                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap; margin-bottom: 10px;">
                        <button class="action-btn" style="background: #8b5cf6; font-size: 1em; padding: 10px 16px;" onclick="FreeTimers.add()">
                            ‚ûï Nuevo Cron√≥metro Libre
                        </button>
                        <span style="color: #888; font-size: 0.85em;">M√∫ltiples timers simult√°neos. Det√©n y asigna nombre/tipo despu√©s.</span>
                    </div>
                    <!-- Lista de cron√≥metros libres activos -->
                    <div id="freeTimersList"></div>
                </div>

                <!-- Barra de Acciones -->
                <div class="action-bar">
                    <button class="action-btn primary" onclick="Timer.stopAllTimers()">‚èπÔ∏è Detener Todo</button>
                    <button class="action-btn success" onclick="CSV.export()">üì• Exportar CSV</button>
                    <label class="action-btn">
                        üì§ Importar CSV
                        <input type="file" id="csvFileInput" accept=".csv" style="display:none">
                    </label>
                    <button class="action-btn danger" onclick="Storage.clear()">üóëÔ∏è Reset</button>
                </div>

                <!-- Historial -->
                <h2>Historial de Actividades <span id="historyCount" style="font-size: 0.6em; color: #888;"></span></h2>
                <!-- Filtros de Per√≠odo -->
                <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 10px; align-items: center;">
                    <button class="action-btn" onclick="Filtros.setPeriodo('today')" style="padding: 6px 12px; font-size: 0.85em;">üìÖ Hoy</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('week')" style="padding: 6px 12px; font-size: 0.85em;">üìÜ Semana</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('month')" style="padding: 6px 12px; font-size: 0.85em;">üóìÔ∏è Mes</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('year')" style="padding: 6px 12px; font-size: 0.85em;">üìä A√±o</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('all')" style="padding: 6px 12px; font-size: 0.85em;">üîÑ Todo</button>
                    <input type="date" id="historyDateFrom" style="padding: 5px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 0.85em;" onchange="Filtros.setCustomRange(this.value, document.getElementById('historyDateTo').value)">
                    <span style="color: #888;">‚Üí</span>
                    <input type="date" id="historyDateTo" style="padding: 5px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 0.85em;" onchange="Filtros.setCustomRange(document.getElementById('historyDateFrom').value, this.value)">
                </div>
                <!-- Filtros Adicionales -->
                <div class="form-row mb-10" style="flex-wrap: wrap; gap: 8px;">
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <select id="historyFilterMaquina" class="form-select" onchange="UI.renderHistory()">
                            <option value="ALL">üè≠ M√°quina</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 90px;">
                        <select id="historyFilterOP" class="form-select" onchange="UI.renderHistory()">
                            <option value="ALL">üìã OP</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 70px;">
                        <select id="historyFilterTurno" class="form-select" onchange="UI.renderHistory()">
                            <option value="ALL">‚è∞ Turno</option>
                            <option value="T1">T1</option>
                            <option value="T2">T2</option>
                            <option value="T3">T3</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 70px;">
                        <select id="historyFilterColores" class="form-select" onchange="UI.renderHistory()">
                            <option value="ALL">üé® Color</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4+</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <select id="historyFilterTipo" class="form-select" onchange="UI.renderHistory()">
                            <option value="ALL">üè∑Ô∏è Tipo</option>
                            <option value="INT">üü† INT</option>
                            <option value="EXT">üü¢ EXT</option>
                            <option value="NVA">üî¥ NVA</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 90px;">
                        <select id="historyFilter" class="form-select" onchange="UI.renderHistory()">
                            <option value="ALL">üìÅ Categor√≠a</option>
                        </select>
                    </div>
                </div>
                <div id="historyList" class="history-container"></div>
            </div>
        </section>

        <!-- ============================================== -->
        <!-- TAB: AN√ÅLISIS -->
        <!-- ============================================== -->
        <section id="tab-analysis" class="view-section">
            <div class="card">
                <h2>An√°lisis Multi-Perspectiva</h2>
                
                <!-- Filtros de Per√≠odo -->
                <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 10px; align-items: center;">
                    <button class="action-btn" onclick="Filtros.setPeriodo('today')" style="padding: 6px 12px; font-size: 0.85em;">üìÖ Hoy</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('week')" style="padding: 6px 12px; font-size: 0.85em;">üìÜ Semana</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('month')" style="padding: 6px 12px; font-size: 0.85em;">üóìÔ∏è Mes</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('year')" style="padding: 6px 12px; font-size: 0.85em;">üìä A√±o</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('all')" style="padding: 6px 12px; font-size: 0.85em;">üîÑ Todo</button>
                    <input type="date" id="analysisDateFrom" style="padding: 5px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 0.85em;" onchange="Filtros.setCustomRange(this.value, document.getElementById('analysisDateTo').value); Analysis.render();">
                    <span style="color: #888;">‚Üí</span>
                    <input type="date" id="analysisDateTo" style="padding: 5px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 0.85em;" onchange="Filtros.setCustomRange(document.getElementById('analysisDateFrom').value, this.value); Analysis.render();">
                </div>
                
                <!-- Filtros Adicionales -->
                <div class="form-row mb-15" style="flex-wrap: wrap; gap: 10px;">
                    <div class="form-group" style="flex:1; min-width: 100px;">
                        <label class="form-label">üè≠ M√°quina:</label>
                        <select id="analysisFilterMaquina" class="form-select" onchange="Analysis.render()">
                            <option value="ALL">Todas</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 110px;">
                        <label class="form-label">üìã OP:</label>
                        <select id="analysisFilterOP" class="form-select" onchange="Analysis.render()">
                            <option value="ALL">Todas las OP</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <label class="form-label">‚è∞ Turno:</label>
                        <select id="analysisFilterTurno" class="form-select" onchange="Analysis.render()">
                            <option value="ALL">Todos</option>
                            <option value="T1">T1</option>
                            <option value="T2">T2</option>
                            <option value="T3">T3</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <label class="form-label">üè∑Ô∏è Tipo:</label>
                        <select id="analysisFilterTipo" class="form-select" onchange="Analysis.render()">
                            <option value="ALL">Todos</option>
                            <option value="INT">üü† INT</option>
                            <option value="EXT">üü¢ EXT</option>
                            <option value="NVA">üî¥ NVA</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 100px;">
                        <label class="form-label">üìÅ Categor√≠a:</label>
                        <select id="analysisFilter" class="form-select" onchange="Analysis.render()">
                            <option value="ALL">Todas</option>
                        </select>
                    </div>
                </div>
                
                <!-- Selector de Vista -->
                <div class="analysis-selector">
                    <select id="analysisView" class="form-select">
                        <option value="general">Vista General</option>
                        <option value="financiero">Vista Financiera</option>
                        <option value="gerencial">Vista Gerencial</option>
                        <option value="operacional">Vista Operacional</option>
                    </select>
                </div>

                <!-- Panel: General -->
                <div id="panel-general" class="view-panel active">
                    <div class="kpi-grid">
                        <div class="kpi-card blue">
                            <div class="kpi-icon">‚è±Ô∏è</div>
                            <div class="kpi-label">Tiempo Total</div>
                            <div class="kpi-value" id="kpi-total">0s</div>
                        </div>
                        <div class="kpi-card red">
                            <div class="kpi-icon">‚ö†Ô∏è</div>
                            <div class="kpi-label">Mudas (Desperdicio)</div>
                            <div class="kpi-value" id="kpi-muda">0s</div>
                        </div>
                        <div class="kpi-card green">
                            <div class="kpi-icon">üìà</div>
                            <div class="kpi-label">Eficiencia</div>
                            <div class="kpi-value" id="kpi-eficiencia">0%</div>
                        </div>
                        <div class="kpi-card yellow">
                            <div class="kpi-icon">üìã</div>
                            <div class="kpi-label">Registros</div>
                            <div class="kpi-value" id="kpi-registros">0</div>
                        </div>
                        <div class="kpi-card purple">
                            <div class="kpi-icon">‚è≥</div>
                            <div class="kpi-label">Promedio</div>
                            <div class="kpi-value" id="kpi-promedio">0s</div>
                        </div>
                    </div>
                </div>

                <!-- Panel: Financiero -->
                <div id="panel-financiero" class="view-panel">
                    <div class="financial-grid">
                        <div class="financial-card cost">
                            <div class="financial-label">üí∏ Costo de Mudas</div>
                            <div class="financial-value" id="fin-costo-muda">Q0.00</div>
                        </div>
                        <div class="financial-card savings">
                            <div class="financial-label">üí∞ Ahorros Potenciales</div>
                            <div class="financial-value" id="fin-ahorros">Q0.00</div>
                        </div>
                        <div class="financial-card roi">
                            <div class="financial-label">üìä ROI Estimado</div>
                            <div class="financial-value" id="fin-roi">0%</div>
                        </div>
                    </div>
                    <div class="recommendation">
                        <div class="recommendation-title">üí° Recomendaci√≥n Financiera:</div>
                        <div class="recommendation-text" id="fin-recomendacion">Sin datos suficientes</div>
                    </div>
                </div>

                <!-- Panel: Gerencial -->
                <div id="panel-gerencial" class="view-panel">
                    <div class="kpi-grid">
                        <div class="kpi-card purple">
                            <div class="kpi-label">Eficiencia Actual</div>
                            <div class="kpi-value" id="ger-eficiencia-actual">0%</div>
                        </div>
                        <div class="kpi-card green">
                            <div class="kpi-label">Meta</div>
                            <div class="kpi-value" id="ger-meta">95%</div>
                        </div>
                        <div class="kpi-card red">
                            <div class="kpi-label">Brecha</div>
                            <div class="kpi-value" id="ger-brecha">0%</div>
                        </div>
                    </div>
                    <div class="recommendation">
                        <div class="recommendation-title">üìä KPIs Gerenciales:</div>
                        <ul style="color: var(--text-secondary); font-size: 0.85rem; padding-left: 20px;">
                            <li>Tiempo promedio de cambio: <strong id="ger-promedio">0s</strong></li>
                            <li>Total de cambios analizados: <strong id="ger-total-cambios">0</strong></li>
                            <li>Tiempo de valor agregado: <strong id="ger-tiempo-va">0s</strong></li>
                        </ul>
                    </div>
                </div>

                <!-- Panel: Operacional -->
                <div id="panel-operacional" class="view-panel">
                    <div class="kpi-grid">
                        <div class="kpi-card yellow">
                            <div class="kpi-label">Ajuste Interno</div>
                            <div class="kpi-value" id="op-ajuste-int">0s</div>
                        </div>
                        <div class="kpi-card green">
                            <div class="kpi-label">Ajuste Externo</div>
                            <div class="kpi-value" id="op-ajuste-ext">0s</div>
                        </div>
                        <div class="kpi-card blue">
                            <div class="kpi-label">Ratio Int/Ext</div>
                            <div class="kpi-value" id="op-ratio">0</div>
                        </div>
                    </div>
                    <div class="recommendation">
                        <div class="recommendation-title">üéØ Estrategia SMED:</div>
                        <div class="recommendation-text" id="op-recomendacion">Convertir actividades internas a externas. Objetivo: reducir ratio a 0.5 o menos.</div>
                    </div>
                </div>

                <!-- Gr√°ficos -->
                <h2 class="mt-10">Gr√°ficos</h2>
                <div class="charts-grid">
                    <div class="chart-container">
                        <div class="chart-title">Distribuci√≥n por Categor√≠a</div>
                        <svg id="barChartSvg" viewBox="0 0 300 180" preserveAspectRatio="xMidYMid meet" style="width:100%; height:180px;"></svg>
                    </div>
                    <div class="chart-container">
                        <div class="chart-title">Proporci√≥n de Tiempos</div>
                        <svg id="pieChartSvg" viewBox="0 0 280 180" preserveAspectRatio="xMidYMid meet" style="width:100%; height:180px;"></svg>
                    </div>
                </div>
                
                <!-- An√°lisis Comparativo MULTI-DIMENSIONAL -->
                <h2 class="mt-10">üìä An√°lisis Comparativo Multi-Dimensional</h2>
                <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">Compara el desempe√±o agrupando por diferentes dimensiones. Los filtros aplicados arriba afectan los resultados.</p>
                
                <!-- Selector de Dimensi√≥n -->
                <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                    <button class="action-btn" onclick="AnalysisComparativo.renderTablaComparativa('comparativoTabla', 'op')" style="background: #10b981;">
                        üìã Comparar por OP
                    </button>
                    <button class="action-btn" onclick="AnalysisComparativo.renderTablaComparativa('comparativoTabla', 'maquina')" style="background: #00d4ff; color: #000;">
                        üè≠ Comparar por M√°quina
                    </button>
                    <button class="action-btn" onclick="AnalysisComparativo.renderTablaComparativa('comparativoTabla', 'turno')" style="background: #f59e0b; color: #000;">
                        ‚è∞ Comparar por Turno
                    </button>
                    <button class="action-btn" onclick="AnalysisComparativo.renderTablaComparativa('comparativoTabla', 'tipo')" style="background: #8b5cf6;">
                        üè∑Ô∏è Comparar por Tipo
                    </button>
                </div>
                
                <!-- Tabla Comparativa -->
                <div id="comparativoTabla" style="margin-bottom: 20px;">
                    <div class="no-data-msg">Selecciona una dimensi√≥n para comparar</div>
                </div>
                
                <!-- An√°lisis Detallado por Categor√≠a -->
                <h2 class="mt-10">üìã An√°lisis Detallado por Categor√≠a</h2>
                <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">Estad√≠sticas detalladas de cada categor√≠a con variabilidad y tendencias.</p>
                <div id="categoriaDetallado"></div>
                <button class="action-btn" onclick="AnalysisDetallado.renderDetallado('categoriaDetallado')" style="background: #8b5cf6;">
                    üîç Cargar An√°lisis Detallado
                </button>
                
                <!-- ============================================== -->
                <!-- COMPARADOR MULTIDIMENSIONAL INTERACTIVO -->
                <!-- ============================================== -->
                <h2 class="mt-10">üî¨ Comparador Multi-Dimensional Interactivo</h2>
                <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">
                    Selecciona m√∫ltiples m√°quinas, OPs o turnos para comparar lado a lado con los mismos filtros aplicados.
                </p>
                
                <div style="background: linear-gradient(135deg, #1a1a2e, #0f0f1a); padding: 20px; border-radius: 12px; border: 1px solid #333;">
                    <!-- Selector de elementos -->
                    <div id="multiDimSelector"></div>
                    
                    <!-- Gr√°ficos de comparaci√≥n -->
                    <div id="multiDimChart" style="margin-top: 20px;"></div>
                </div>
                
                <script>
                    // Inicializar comparador al cargar
                    setTimeout(() => {
                        if (typeof MultiDimComparator !== 'undefined') {
                            MultiDimComparator.renderSelector('multiDimSelector');
                            MultiDimComparator.renderComparison('multiDimChart');
                        }
                    }, 500);
                </script>
            </div>
        </section>

        <!-- ============================================== -->
        <!-- TAB: GANTT -->
        <!-- ============================================== -->
        <section id="tab-gantt" class="view-section">
            <div class="card">
                <h2>Diagrama de Gantt - Timeline de Actividades</h2>
                
                <!-- Filtros de Per√≠odo -->
                <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 10px; align-items: center;">
                    <button class="action-btn" onclick="Filtros.setPeriodo('today')" style="padding: 6px 12px; font-size: 0.85em;">üìÖ Hoy</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('week')" style="padding: 6px 12px; font-size: 0.85em;">üìÜ Semana</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('month')" style="padding: 6px 12px; font-size: 0.85em;">üóìÔ∏è Mes</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('year')" style="padding: 6px 12px; font-size: 0.85em;">üìä A√±o</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('all')" style="padding: 6px 12px; font-size: 0.85em;">üîÑ Todo</button>
                    <input type="date" id="ganttDateFrom" style="padding: 5px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 0.85em;" onchange="Filtros.setCustomRange(this.value, document.getElementById('ganttDateTo').value); Gantt.render();">
                    <span style="color: #888;">‚Üí</span>
                    <input type="date" id="ganttDateTo" style="padding: 5px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 0.85em;" onchange="Filtros.setCustomRange(document.getElementById('ganttDateFrom').value, this.value); Gantt.render();">
                </div>
                
                <!-- Filtros del Gantt -->
                <div class="form-row mb-15" style="flex-wrap: wrap; gap: 10px;">
                    <div class="form-group" style="flex:1; min-width: 100px;">
                        <label class="form-label">üè≠ M√°quina:</label>
                        <select id="ganttFilterMaquina" class="form-select" onchange="Gantt.render()">
                            <option value="ALL">Todas</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 120px;">
                        <label class="form-label">üìã OP:</label>
                        <select id="ganttFilterOP" class="form-select" onchange="Gantt.render()">
                            <option value="ALL">Todas las OP</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <label class="form-label">‚è∞ Turno:</label>
                        <select id="ganttFilterTurno" class="form-select" onchange="Gantt.render()">
                            <option value="ALL">Todos</option>
                            <option value="T1">T1</option>
                            <option value="T2">T2</option>
                            <option value="T3">T3</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <label class="form-label">üé® Colores:</label>
                        <select id="ganttFilterColores" class="form-select" onchange="Gantt.render()">
                            <option value="ALL">Todos</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5+</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <label class="form-label">üè∑Ô∏è Tipo:</label>
                        <select id="ganttFilterTipo" class="form-select" onchange="Gantt.render()">
                            <option value="ALL">Todos</option>
                            <option value="INT">üü† INT</option>
                            <option value="EXT">üü¢ EXT</option>
                            <option value="NVA">üî¥ NVA</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 100px;">
                        <label class="form-label">üìÅ Categor√≠a:</label>
                        <select id="ganttFilter" class="form-select" onchange="Gantt.render()">
                            <option value="ALL">Todas</option>
                        </select>
                    </div>
                </div>
                
                <!-- Leyenda de colores -->
                <div style="display: flex; gap: 15px; margin-bottom: 10px; font-size: 0.75rem; flex-wrap: wrap;">
                    <span style="display: flex; align-items: center; gap: 5px;">
                        <span style="width: 16px; height: 10px; background: #f97316; border-radius: 2px;"></span> INT (Interna - m√°q. parada)
                    </span>
                    <span style="display: flex; align-items: center; gap: 5px;">
                        <span style="width: 16px; height: 10px; background: #10b981; border-radius: 2px;"></span> EXT (Externa - m√°q. andando)
                    </span>
                    <span style="display: flex; align-items: center; gap: 5px;">
                        <span style="width: 16px; height: 10px; background: #ef4444; border-radius: 2px;"></span> NVA (Muda/Desperdicio)
                    </span>
                </div>

                <div class="gantt-header">
                    <div class="gantt-controls">
                        <button class="action-btn" onclick="Gantt.zoomOut()">‚àí</button>
                        <button class="action-btn" onclick="Gantt.resetZoom()">100%</button>
                        <button class="action-btn" onclick="Gantt.zoomIn()">+</button>
                    </div>
                </div>

                <div class="gantt-container">
                    <div id="ganttTimeline" class="gantt-timeline">
                        <div class="no-data-msg">No hay actividades registradas</div>
                    </div>
                    <div id="ganttScale" class="gantt-scale"></div>
                </div>

                <div class="kpi-grid mt-10">
                    <div class="kpi-card blue">
                        <div class="kpi-label">Total Actividades</div>
                        <div class="kpi-value" id="gantt-total">0s</div>
                    </div>
                    <div class="kpi-card green">
                        <div class="kpi-label">Valor Agregado</div>
                        <div class="kpi-value" id="gantt-va">0s</div>
                    </div>
                    <div class="kpi-card red">
                        <div class="kpi-label">No Valor Agregado</div>
                        <div class="kpi-value" id="gantt-nva">0s</div>
                    </div>
                    <div class="kpi-card purple">
                        <div class="kpi-label">‚è±Ô∏è Tiempo Neto Cambio</div>
                        <div class="kpi-value" id="gantt-neto">0s</div>
                        <div style="font-size: 0.7em; color: #888;" id="gantt-neto-rango">Inicio ‚Üí Fin</div>
                    </div>
                </div>

                <div class="action-bar">
                    <button class="action-btn" onclick="Gantt.render()">üìä Vista Secuencial</button>
                    <button class="action-btn" onclick="Gantt.renderByCategory()">üìà Vista por Categor√≠a</button>
                </div>
                
                <!-- An√°lisis Comparativo Multi-Dimensional para Gantt -->
                <h2 class="mt-10">üìä Vista Comparativa Multi-Dimensional</h2>
                <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">
                    Compara el desempe√±o agrupando por OP, M√°quina o Turno. Los colores muestran la distribuci√≥n INT/EXT/NVA.
                </p>
                
                <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                    <button class="action-btn" onclick="Gantt.renderByOP()" style="background: #00ff9d; color: #000;">
                        üìã Comparar por OP
                    </button>
                    <button class="action-btn" onclick="Gantt.renderByMaquina()" style="background: #00d4ff; color: #000;">
                        üè≠ Comparar por M√°quina
                    </button>
                    <button class="action-btn" onclick="Gantt.renderByTurno()" style="background: #f59e0b; color: #000;">
                        ‚è∞ Comparar por Turno
                    </button>
                    <button class="action-btn" onclick="Gantt.renderByTipo()" style="background: #8b5cf6;">
                        üè∑Ô∏è Comparar por Tipo
                    </button>
                </div>
            </div>
        </section>

        <!-- ============================================== -->
        <!-- TAB: ESTAD√çSTICA -->
        <!-- ============================================== -->
        <section id="tab-stats" class="view-section">
            <div class="card">
                <h2 style="color: var(--accent-primary);">An√°lisis Estad√≠stico Avanzado</h2>
                
                <!-- Filtros de Per√≠odo -->
                <div style="display: flex; gap: 5px; flex-wrap: wrap; margin-bottom: 10px; align-items: center;">
                    <button class="action-btn" onclick="Filtros.setPeriodo('today')" style="padding: 6px 12px; font-size: 0.85em;">üìÖ Hoy</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('week')" style="padding: 6px 12px; font-size: 0.85em;">üìÜ Semana</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('month')" style="padding: 6px 12px; font-size: 0.85em;">üóìÔ∏è Mes</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('year')" style="padding: 6px 12px; font-size: 0.85em;">üìä A√±o</button>
                    <button class="action-btn" onclick="Filtros.setPeriodo('all')" style="padding: 6px 12px; font-size: 0.85em;">üîÑ Todo</button>
                    <input type="date" id="statsDateFrom" style="padding: 5px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 0.85em;" onchange="Filtros.setCustomRange(this.value, document.getElementById('statsDateTo').value); Statistics.calculate();">
                    <span style="color: #888;">‚Üí</span>
                    <input type="date" id="statsDateTo" style="padding: 5px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 0.85em;" onchange="Filtros.setCustomRange(document.getElementById('statsDateFrom').value, this.value); Statistics.calculate();">
                </div>
                
                <!-- Filtros por M√°quina, OP, Turno, Colores -->
                <div class="form-row mb-15" style="flex-wrap: wrap; gap: 10px;">
                    <div class="form-group" style="flex:1; min-width: 100px;">
                        <label class="form-label">üè≠ M√°quina:</label>
                        <select id="statsFilterMaquina" class="form-select" onchange="Statistics.calculate()">
                            <option value="ALL">Todas</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 110px;">
                        <label class="form-label">üìã OP:</label>
                        <select id="statsFilterOP" class="form-select" onchange="Statistics.calculate()">
                            <option value="ALL">Todas las OP</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <label class="form-label">‚è∞ Turno:</label>
                        <select id="statsFilterTurno" class="form-select" onchange="Statistics.calculate()">
                            <option value="ALL">Todos</option>
                            <option value="T1">T1</option>
                            <option value="T2">T2</option>
                            <option value="T3">T3</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <label class="form-label">üé® Colores:</label>
                        <select id="statsFilterColores" class="form-select" onchange="Statistics.calculate()">
                            <option value="ALL">Todos</option>
                            <option value="1">1</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5+</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 80px;">
                        <label class="form-label">üè∑Ô∏è Tipo:</label>
                        <select id="statsFilterTipo" class="form-select" onchange="Statistics.calculate()">
                            <option value="ALL">Todos</option>
                            <option value="INT">üü† INT</option>
                            <option value="EXT">üü¢ EXT</option>
                            <option value="NVA">üî¥ NVA</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 100px;">
                        <label class="form-label">üìÅ Categor√≠a:</label>
                        <select id="statsFilter" class="form-select" onchange="Statistics.calculate()">
                            <option value="ALL">Todas</option>
                        </select>
                    </div>
                </div>

                <!-- Estad√≠sticas B√°sicas -->
                <h2>Estad√≠sticas Descriptivas</h2>
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-label">Min</span>
                        <span class="stat-value" id="st-min">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Q1 (25%)</span>
                        <span class="stat-value" id="st-q1">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Mediana</span>
                        <span class="stat-value" id="st-med">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Q3 (75%)</span>
                        <span class="stat-value" id="st-q3">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Max</span>
                        <span class="stat-value" id="st-max">--</span>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-label">Media (Œº)</span>
                        <span class="stat-value" id="st-mean">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Desv. Est. (œÉ)</span>
                        <span class="stat-value" id="st-stddev">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">CV (%)</span>
                        <span class="stat-value" id="st-cv">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">N</span>
                        <span class="stat-value" id="st-n">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Rango</span>
                        <span class="stat-value" id="st-range">--</span>
                    </div>
                </div>

                <!-- Box Plot -->
                <h2>Diagrama de Vela (Box Plot)</h2>
                <div id="boxPlotContainer" class="boxplot-container">
                    <div class="no-data-msg">Se necesitan al menos 2 registros</div>
                </div>

                <!-- Curva de Gauss -->
                <h2>Distribuci√≥n Normal (Curva de Gauss)</h2>
                <div class="gauss-container">
                    <svg id="bellCurve" viewBox="0 0 300 150" preserveAspectRatio="xMidYMid meet"></svg>
                </div>

                <!-- Six Sigma -->
                <h2>M√©tricas Six Sigma</h2>
                <div class="stats-grid">
                    <div class="stat-box">
                        <span class="stat-label">Cp</span>
                        <span class="stat-value" id="ss-cp">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Cpk</span>
                        <span class="stat-value" id="ss-cpk">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Nivel œÉ</span>
                        <span class="stat-value" id="ss-sigma">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">DPMO</span>
                        <span class="stat-value" id="ss-dpmo">--</span>
                    </div>
                    <div class="stat-box">
                        <span class="stat-label">Clasificaci√≥n</span>
                        <span class="stat-value" id="ss-class">--</span>
                    </div>
                </div>

                <div class="recommendation">
                    <div class="recommendation-title">üìà Interpretaci√≥n Six Sigma:</div>
                    <div class="recommendation-text">
                        <strong>Cp/Cpk:</strong> &gt;1.33 = Bueno, &gt;1.67 = Excelente, &gt;2.0 = Clase Mundial<br>
                        <strong>CV:</strong> &lt;15% = Estable, 15-30% = Moderado, &gt;30% = Inestable
                    </div>
                </div>
                
                <!-- Panel de Interpretaci√≥n Profunda -->
                <h2 style="margin-top: 25px;">üìñ Interpretaci√≥n Detallada</h2>
                <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">An√°lisis profundo con explicaciones de qu√© significan los n√∫meros, por qu√© son as√≠ y c√≥mo mejorarlos.</p>
                <div id="statsInterpretationPanel">
                    <div class="no-data-msg">Se necesitan datos para generar la interpretaci√≥n</div>
                </div>
                <button class="action-btn" onclick="StatsInterpretation.renderPanel('statsInterpretationPanel')" style="margin-top: 15px; background: #6366f1;">
                    üîç Generar Interpretaci√≥n Detallada
                </button>
                
                <!-- ============================================== -->
                <!-- COMPARADOR ESTAD√çSTICO MULTI-DIMENSIONAL -->
                <!-- ============================================== -->
                <h2 class="mt-10">üî¨ Comparador Estad√≠stico Multi-Dimensional</h2>
                <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">
                    Selecciona m√∫ltiples m√°quinas, OPs o turnos para comparar sus estad√≠sticas lado a lado con Box Plots y m√©tricas Six Sigma.
                </p>
                
                <div style="background: linear-gradient(135deg, #1a1a2e, #0f0f1a); padding: 20px; border-radius: 12px; border: 1px solid #333;">
                    <!-- Selector de elementos -->
                    <div id="statsMultiSelector"></div>
                    
                    <!-- Gr√°ficos de comparaci√≥n -->
                    <div id="statsMultiChart" style="margin-top: 20px;"></div>
                </div>
                
                <script>
                    // Inicializar comparador estad√≠stico al cargar
                    setTimeout(() => {
                        if (typeof StatsMultiComparator !== 'undefined') {
                            StatsMultiComparator.renderSelector('statsMultiSelector');
                            StatsMultiComparator.renderComparison('statsMultiChart');
                        }
                    }, 600);
                </script>
            </div>
        </section>

        <!-- ============================================== -->
        <!-- TAB: INFORMES -->
        <!-- ============================================== -->
        <section id="tab-reports" class="view-section">
            <div class="card">
                <h2>üìÑ Generador de Informes</h2>
                <p style="color: #888; margin-bottom: 15px;">Configura qu√© secciones incluir en el informe. La configuraci√≥n se guarda para futuras exportaciones.</p>
                
                <!-- Configuraci√≥n del Informe -->
                <div style="background: #1a1a2e; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <h3 style="margin-top:0; color: #00d4ff;">üìã Configuraci√≥n del Informe</h3>
                    
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-bottom: 15px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirEncabezado" checked> üìù Encabezado y t√≠tulo
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirResumen" checked> üìä Resumen ejecutivo (KPIs)
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirGraficoBarras" checked> üìà Gr√°fico por categor√≠a
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirGraficoPastel" checked> ü•ß Gr√°fico por tipo (INT/EXT/NVA)
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirGantt"> üìâ Referencia a Gantt
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirBoxPlot" checked> üì¶ Box Plot (estad√≠sticos)
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirTablaDetalle" checked> üìã Tabla detalle de actividades
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirSixSigma" checked> üìê M√©tricas Six Sigma
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirRecomendaciones" checked> üí° Recomendaciones autom√°ticas
                        </label>
                    </div>
                    
                    <!-- Comparativas Multidimensionales -->
                    <h4 style="margin: 15px 0 10px 0; color: #f59e0b;">üìä Comparativas Multidimensionales</h4>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; margin-bottom: 15px;">
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirComparativoOP" checked> üìã Comparativo por OP
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirComparativoMaquina" checked> üè≠ Comparativo por M√°quina
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirComparativoTurno" checked> ‚è∞ Comparativo por Turno
                        </label>
                        <label style="display: flex; align-items: center; gap: 8px; cursor: pointer;">
                            <input type="checkbox" id="incluirPareto" checked> üìà An√°lisis Pareto (80/20)
                        </label>
                    </div>
                    
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                        <div style="flex: 1; min-width: 200px;">
                            <label style="font-size: 10px; color: #888;">T√≠tulo del Informe:</label>
                            <input type="text" id="reportTitulo" value="Informe de An√°lisis SMED" 
                                   style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #fff;">
                        </div>
                        <div style="flex: 1; min-width: 200px;">
                            <label style="font-size: 10px; color: #888;">Empresa / Planta:</label>
                            <input type="text" id="reportEmpresa" value="Planta Corrugadora" 
                                   style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #fff;">
                        </div>
                    </div>
                    
                    <button class="action-btn" onclick="Reports.saveConfig()" style="background: #8b5cf6;">
                        üíæ Guardar Configuraci√≥n
                    </button>
                </div>
                
                <!-- Filtros Aplicados -->
                <div style="background: #0f0f1a; padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #333;">
                    <h3 style="margin-top:0; color: #f59e0b;">üìã Filtros Activos</h3>
                    <p style="color: #888; font-size: 0.9em; margin: 0;">
                        El informe usar√° los filtros actualmente aplicados en la app:<br>
                        <span style="color: #00ff9d;">M√°quina, OP, Turno, Categor√≠a, Per√≠odo</span>
                    </p>
                    <p style="color: #00d4ff; font-size: 0.85em; margin-top: 10px;">
                        üí° Configura los filtros en las pesta√±as Reloj, Gantt o Stats antes de exportar.
                    </p>
                </div>
                
                <!-- Botones de Exportaci√≥n -->
                <div class="action-bar" style="flex-wrap: wrap; gap: 10px;">
                    <button class="action-btn" onclick="Reports.preview()" style="background: #6366f1; font-size: 1.1em; padding: 12px 20px;">
                        üëÅÔ∏è Vista Previa
                    </button>
                    <button class="action-btn success" onclick="Reports.exportPDF()" style="font-size: 1.1em; padding: 12px 20px;">
                        üì• Exportar PDF
                    </button>
                    <button class="action-btn primary" onclick="Reports.exportHTML()" style="font-size: 1.1em; padding: 12px 20px;">
                        üåê Exportar HTML
                    </button>
                </div>
                
                <div class="recommendation" style="margin-top: 15px;">
                    <div class="recommendation-title">üí° Consejos de Exportaci√≥n:</div>
                    <div class="recommendation-text">
                        <strong>üì• PDF:</strong> Se abre vista previa. En el di√°logo de impresi√≥n, selecciona "Guardar como PDF"<br>
                        <strong>üåê HTML:</strong> Archivo editable. Puedes abrirlo en Word, Google Docs o cualquier navegador<br>
                        <strong>üìã Google Docs:</strong> Exporta HTML y s√∫belo a Google Drive, luego "Abrir con Google Docs"
                    </div>
                </div>
                
                <!-- ============================================== -->
                <!-- CONFIGURACIONES GUARDADAS DE EXPORTACI√ìN -->
                <!-- ============================================== -->
                <div style="background: linear-gradient(135deg, #1a1a2e, #0f0f1a); padding: 20px; border-radius: 12px; border: 1px solid #00ff9d; margin-top: 20px;">
                    <h3 style="margin-top: 0; color: #00ff9d;">üìÇ Configuraciones Guardadas</h3>
                    <p style="color: #888; font-size: 0.9em; margin-bottom: 15px;">
                        Guarda tus configuraciones de filtros y opciones para reutilizarlas en futuras exportaciones.
                        Incluye los comparadores multidimensionales seleccionados.
                    </p>
                    
                    <!-- Botones de acci√≥n -->
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 15px;">
                        <button class="action-btn success" onclick="SavedExportConfigs.saveWithName()" style="padding: 10px 16px;">
                            üíæ Guardar Configuraci√≥n Actual
                        </button>
                        <button class="action-btn" onclick="SavedExportConfigs.exportAll()" style="padding: 10px 16px;">
                            üì§ Backup de Configs
                        </button>
                        <label class="action-btn" style="padding: 10px 16px; cursor: pointer;">
                            üì• Importar Configs
                            <input type="file" accept=".json" style="display:none" onchange="SavedExportConfigs.importFromFile(this.files[0]); this.value='';">
                        </label>
                    </div>
                    
                    <!-- Lista de configuraciones guardadas -->
                    <div id="savedConfigsList">
                        <div style="text-align: center; padding: 20px; color: #666;">
                            <p>üìÇ No hay configuraciones guardadas</p>
                        </div>
                    </div>
                </div>
                
                <script>
                    // Cargar lista de configuraciones guardadas al cargar
                    setTimeout(() => {
                        if (typeof SavedExportConfigs !== 'undefined') {
                            SavedExportConfigs.renderList('savedConfigsList');
                        }
                    }, 400);
                </script>
            </div>
        </section>

        <!-- ============================================== -->
        <!-- TAB: TEOR√çA -->
        <!-- ============================================== -->
        <section id="tab-theory" class="view-section">
            <div class="card" style="line-height: 1.6;">
                <h1 style="color: var(--accent-primary); border-bottom: 2px solid var(--accent-primary); padding-bottom: 10px;">
                    üìö Manual Completo: SMED, Lean Manufacturing y Six Sigma
                </h1>
                
                <!-- √çndice -->
                <div style="background: #1a1a2e; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                    <h3 style="margin-top:0;">üìë √çndice de Contenidos</h3>
                    <ol style="color: var(--text-secondary); column-count: 2; column-gap: 30px;">
                        <li>Introducci√≥n a SMED</li>
                        <li>Historia y Origen</li>
                        <li>Las 4 Etapas SMED</li>
                        <li>Lean Manufacturing</li>
                        <li>Los 8 Desperdicios (MUDA)</li>
                        <li>Six Sigma</li>
                        <li>DMAIC</li>
                        <li>Niveles de Certificaci√≥n</li>
                        <li>Herramientas Lean</li>
                        <li>M√©tricas y KPIs</li>
                        <li>Casos de √âxito</li>
                        <li>Referencias</li>
                    </ol>
                </div>

                <!-- 1. SMED -->
                <h2>1. SMED (Single-Minute Exchange of Die)</h2>
                <p><strong>SMED</strong> es una metodolog√≠a desarrollada para reducir dr√°sticamente los tiempos de cambio de formato (setup) en m√°quinas industriales. El objetivo es lograr tiempos de cambio de menos de 10 minutos ("single-minute" = un solo d√≠gito de minutos).</p>
                
                <div style="background: #0f0f1a; padding: 15px; border-left: 4px solid #00ff9d; margin: 15px 0;">
                    <strong>Definici√≥n t√©cnica:</strong> El tiempo de cambio de formato (setup time) se define como el intervalo entre la √∫ltima pieza buena del lote anterior y la primera pieza buena del lote siguiente.
                </div>

                <!-- 2. Historia -->
                <h2>2. Historia y Origen</h2>
                <p>La metodolog√≠a SMED fue desarrollada por <strong>Shigeo Shingo</strong> (1909-1990), ingeniero industrial japon√©s, durante su trabajo con Toyota Motor Corporation entre 1950 y 1969.</p>
                
                <h3>Cronolog√≠a del desarrollo:</h3>
                <table class="theory-table">
                    <tr><th>A√±o</th><th>Evento</th><th>Resultado</th></tr>
                    <tr><td>1950</td><td>Shingo analiza cambios de dado en Toyo Kogyo</td><td>Identifica actividades internas/externas</td></tr>
                    <tr><td>1957</td><td>Mejoras en astillero de Mitsubishi Heavy Industries</td><td>Reducci√≥n del 50% en tiempo de setup</td></tr>
                    <tr><td>1969</td><td>Toyota - Prensa de 1000 toneladas</td><td>De 4 horas a 3 minutos</td></tr>
                    <tr><td>1985</td><td>Publicaci√≥n del libro "A Revolution in Manufacturing"</td><td>SMED se difunde mundialmente</td></tr>
                </table>

                <div style="background: #1a1a2e; padding: 15px; border-radius: 8px; margin: 15px 0;">
                    <strong>üìñ Cita de Shigeo Shingo:</strong><br>
                    <em>"El SMED naci√≥ de la necesidad de lograr la producci√≥n Just-in-Time, una de las piedras angulares del sistema de producci√≥n de Toyota."</em>
                </div>

                <!-- 3. Las 4 Etapas SMED -->
                <h2>3. Las 4 Etapas de la Metodolog√≠a SMED</h2>
                
                <h3>Etapa 0: Fase Preliminar - Documentar el Estado Actual</h3>
                <p>En esta fase inicial, no existe distinci√≥n entre actividades internas y externas. El objetivo es observar y registrar todas las operaciones actuales del cambio de formato.</p>
                <ul>
                    <li>Grabar en video todo el proceso de cambio</li>
                    <li>Registrar tiempos con cron√≥metro</li>
                    <li>Documentar secuencia de actividades</li>
                    <li>Identificar todos los participantes y sus roles</li>
                </ul>

                <h3>Etapa 1: Separar Actividades Internas de Externas</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
                    <div style="background: #f97316; color: #000; padding: 15px; border-radius: 8px;">
                        <h4 style="margin-top:0;">üü† Actividades INTERNAS</h4>
                        <p>Solo pueden realizarse con la m√°quina <strong>DETENIDA</strong></p>
                        <ul style="margin:0;">
                            <li>Montar/desmontar herramentales</li>
                            <li>Ajustar topes y gu√≠as</li>
                            <li>Calibrar instrumentos</li>
                        </ul>
                    </div>
                    <div style="background: #10b981; color: #000; padding: 15px; border-radius: 8px;">
                        <h4 style="margin-top:0;">üü¢ Actividades EXTERNAS</h4>
                        <p>Pueden realizarse con la m√°quina <strong>EN MARCHA</strong></p>
                        <ul style="margin:0;">
                            <li>Buscar herramientas</li>
                            <li>Pre-calentar moldes</li>
                            <li>Preparar materiales</li>
                        </ul>
                    </div>
                </div>
                <p><strong>Reducci√≥n t√≠pica:</strong> 30-50% del tiempo original</p>

                <h3>Etapa 2: Convertir Actividades Internas en Externas</h3>
                <p>Esta es la fase m√°s creativa y cr√≠tica. Se buscan formas de realizar actividades antes consideradas internas mientras la m√°quina a√∫n est√° produciendo.</p>
                <table class="theory-table">
                    <tr><th>Antes (Interna)</th><th>Despu√©s (Externa)</th><th>T√©cnica</th></tr>
                    <tr><td>Calentar molde en m√°quina</td><td>Pre-calentar fuera de l√≠nea</td><td>Pre-calentamiento</td></tr>
                    <tr><td>Ajustar altura del dado</td><td>Usar plantillas de altura fija</td><td>Estandarizaci√≥n</td></tr>
                    <tr><td>Buscar herramientas</td><td>Kit de herramientas preparado</td><td>Preparaci√≥n anticipada</td></tr>
                </table>
                <p><strong>Reducci√≥n adicional:</strong> 25-50% del tiempo restante</p>

                <h3>Etapa 3: Optimizar Todas las Operaciones</h3>
                <p>Se busca reducir a√∫n m√°s el tiempo de cada actividad individual mediante:</p>
                <ul>
                    <li><strong>Operaciones paralelas:</strong> Dos o m√°s personas trabajando simult√°neamente</li>
                    <li><strong>Fijaciones funcionales:</strong> Eliminar tornillos, usar cierres r√°pidos</li>
                    <li><strong>Eliminaci√≥n de ajustes:</strong> Uso de topes fijos, escalas graduadas</li>
                    <li><strong>Mecanizaci√≥n:</strong> Sistemas hidr√°ulicos, neum√°ticos o el√©ctricos</li>
                </ul>

                <!-- 4. Lean Manufacturing -->
                <h2>4. Lean Manufacturing</h2>
                <p><strong>Lean Manufacturing</strong> (Manufactura Esbelta) es un sistema de producci√≥n que busca eliminar todo tipo de desperdicio (muda) para crear valor m√°ximo con recursos m√≠nimos.</p>
                
                <h3>Los 5 Principios Lean</h3>
                <ol>
                    <li><strong>Definir Valor:</strong> Desde la perspectiva del cliente</li>
                    <li><strong>Mapear la Cadena de Valor:</strong> Identificar todos los pasos del proceso</li>
                    <li><strong>Crear Flujo:</strong> Eliminar interrupciones y cuellos de botella</li>
                    <li><strong>Establecer Pull:</strong> Producir solo lo que el cliente demanda</li>
                    <li><strong>Buscar la Perfecci√≥n:</strong> Mejora continua (Kaizen)</li>
                </ol>

                <!-- 5. Los 8 Desperdicios -->
                <h2>5. Los 8 Desperdicios (MUDA) - TIMWOODS</h2>
                <p>El acr√≥nimo <strong>TIMWOODS</strong> (o DOWNTIME) representa los 8 tipos de desperdicio identificados en Lean:</p>
                
                <table class="theory-table">
                    <tr><th>Letra</th><th>Desperdicio</th><th>Descripci√≥n</th><th>Ejemplos</th></tr>
                    <tr><td>T</td><td>Transporte</td><td>Movimiento innecesario de materiales</td><td>Layouts mal dise√±ados, almacenes lejanos</td></tr>
                    <tr><td>I</td><td>Inventario</td><td>Exceso de materiales/WIP/producto terminado</td><td>Stock de seguridad excesivo, lotes grandes</td></tr>
                    <tr><td>M</td><td>Movimiento</td><td>Movimientos innecesarios de personas</td><td>Buscar herramientas, caminar largas distancias</td></tr>
                    <tr><td>W</td><td>Espera (Waiting)</td><td>Tiempo ocioso esperando</td><td>Falta de material, cuellos de botella</td></tr>
                    <tr><td>O</td><td>Sobreproducci√≥n</td><td>Producir m√°s de lo necesario</td><td>Producir "por si acaso", lotes grandes</td></tr>
                    <tr><td>O</td><td>Sobreprocesamiento</td><td>M√°s procesamiento del necesario</td><td>Inspecciones redundantes, tolerancias innecesarias</td></tr>
                    <tr><td>D</td><td>Defectos</td><td>Productos que no cumplen especificaciones</td><td>Retrabajos, scrap, devoluciones</td></tr>
                    <tr><td>S</td><td>Skills (Talento)</td><td>No utilizar el conocimiento del personal</td><td>Ideas ignoradas, falta de capacitaci√≥n</td></tr>
                </table>

                <!-- 6. Six Sigma -->
                <h2>6. Six Sigma</h2>
                <p><strong>Six Sigma</strong> es una metodolog√≠a de mejora de procesos basada en datos estad√≠sticos, desarrollada por <strong>Bill Smith</strong> en Motorola (1986) y popularizada por <strong>Jack Welch</strong> en General Electric (1995).</p>
                
                <h3>Niveles Sigma y DPMO</h3>
                <table class="theory-table">
                    <tr><th>Nivel œÉ</th><th>DPMO</th><th>Rendimiento</th><th>Clasificaci√≥n</th></tr>
                    <tr><td>1œÉ</td><td>691,462</td><td>30.85%</td><td>No competitivo</td></tr>
                    <tr><td>2œÉ</td><td>308,538</td><td>69.15%</td><td>Promedio industria</td></tr>
                    <tr><td>3œÉ</td><td>66,807</td><td>93.32%</td><td>Aceptable</td></tr>
                    <tr><td>4œÉ</td><td>6,210</td><td>99.38%</td><td>Bueno</td></tr>
                    <tr><td>5œÉ</td><td>233</td><td>99.977%</td><td>Excelente</td></tr>
                    <tr><td>6œÉ</td><td>3.4</td><td>99.99966%</td><td>Clase Mundial</td></tr>
                </table>
                <p><em>DPMO = Defectos Por Mill√≥n de Oportunidades</em></p>

                <!-- 7. DMAIC -->
                <h2>7. DMAIC - El Ciclo de Mejora Six Sigma</h2>
                <div style="display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin: 20px 0;">
                    <div style="background: #3b82f6; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong style="font-size: 1.5em;">D</strong><br>Define<br><small>Definir</small>
                    </div>
                    <div style="background: #10b981; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong style="font-size: 1.5em;">M</strong><br>Measure<br><small>Medir</small>
                    </div>
                    <div style="background: #f59e0b; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong style="font-size: 1.5em;">A</strong><br>Analyze<br><small>Analizar</small>
                    </div>
                    <div style="background: #ef4444; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong style="font-size: 1.5em;">I</strong><br>Improve<br><small>Mejorar</small>
                    </div>
                    <div style="background: #8b5cf6; padding: 15px; border-radius: 8px; text-align: center;">
                        <strong style="font-size: 1.5em;">C</strong><br>Control<br><small>Controlar</small>
                    </div>
                </div>

                <!-- 8. Certificaciones -->
                <h2>8. Niveles de Certificaci√≥n Six Sigma</h2>
                <table class="theory-table">
                    <tr><th>Belt</th><th>Rol</th><th>Horas Formaci√≥n</th><th>Proyectos</th></tr>
                    <tr><td>‚ö™ White Belt</td><td>Participante de equipo</td><td>4-8 horas</td><td>Apoyo b√°sico</td></tr>
                    <tr><td>üü° Yellow Belt</td><td>Miembro activo de proyecto</td><td>16-24 horas</td><td>Participa en proyectos</td></tr>
                    <tr><td>üü¢ Green Belt</td><td>L√≠der de proyecto</td><td>80-120 horas</td><td>1-2 proyectos/a√±o</td></tr>
                    <tr><td>‚ö´ Black Belt</td><td>Experto y mentor</td><td>160-240 horas</td><td>4-6 proyectos/a√±o</td></tr>
                    <tr><td>‚ö´‚ö´ Master BB</td><td>Estratega organizacional</td><td>+300 horas</td><td>Coaching y estrategia</td></tr>
                </table>

                <!-- 9. Herramientas -->
                <h2>9. Herramientas Lean Six Sigma</h2>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <h4>Herramientas de An√°lisis:</h4>
                        <ul>
                            <li>Diagrama de Ishikawa (Causa-Efecto)</li>
                            <li>5 Porqu√©s</li>
                            <li>Diagrama de Pareto</li>
                            <li>FMEA (An√°lisis de Modos de Falla)</li>
                            <li>An√°lisis de Regresi√≥n</li>
                        </ul>
                    </div>
                    <div>
                        <h4>Herramientas de Control:</h4>
                        <ul>
                            <li>Gr√°ficos de Control (SPC)</li>
                            <li>Cp, Cpk, Pp, Ppk</li>
                            <li>Poka-Yoke (A prueba de errores)</li>
                            <li>Estandarizaci√≥n de trabajo</li>
                            <li>Visual Management</li>
                        </ul>
                    </div>
                </div>

                <!-- 10. M√©tricas -->
                <h2>10. M√©tricas y KPIs</h2>
                <table class="theory-table">
                    <tr><th>M√©trica</th><th>F√≥rmula</th><th>Meta t√≠pica</th></tr>
                    <tr><td>OEE (Eficiencia Global)</td><td>Disponibilidad √ó Rendimiento √ó Calidad</td><td>‚â•85%</td></tr>
                    <tr><td>Tiempo de Ciclo</td><td>Tiempo total / Unidades producidas</td><td>Reducir</td></tr>
                    <tr><td>Lead Time</td><td>Desde pedido hasta entrega</td><td>Reducir</td></tr>
                    <tr><td>Takt Time</td><td>Tiempo disponible / Demanda cliente</td><td>Ritmo objetivo</td></tr>
                    <tr><td>First Pass Yield</td><td>Unidades buenas / Total producido</td><td>‚â•99%</td></tr>
                </table>

                <!-- 11. Casos de √©xito -->
                <h2>11. Casos de √âxito Documentados</h2>
                <ul>
                    <li><strong>Toyota:</strong> Reducci√≥n de setup de prensa de 4 horas a 3 minutos</li>
                    <li><strong>Motorola:</strong> Ahorros de $17 mil millones con Six Sigma</li>
                    <li><strong>GE:</strong> $12 mil millones en beneficios en 5 a√±os</li>
                    <li><strong>3M:</strong> 50% de reducci√≥n en tiempo de desarrollo de productos</li>
                </ul>

                <!-- 12. Referencias -->
                <h2>12. Referencias Bibliogr√°ficas</h2>
                <div style="background: #1a1a2e; padding: 15px; border-radius: 8px; font-size: 0.9em;">
                    <p><strong>Libros fundamentales:</strong></p>
                    <ul>
                        <li>Shingo, S. (1985). <em>A Revolution in Manufacturing: The SMED System</em>. Productivity Press.</li>
                        <li>Womack, J. & Jones, D. (1996). <em>Lean Thinking</em>. Simon & Schuster.</li>
                        <li>Ohno, T. (1988). <em>Toyota Production System</em>. Productivity Press.</li>
                        <li>George, M. (2002). <em>Lean Six Sigma</em>. McGraw-Hill.</li>
                        <li>Liker, J. (2004). <em>The Toyota Way</em>. McGraw-Hill.</li>
                    </ul>
                    <p><strong>Normas y est√°ndares:</strong></p>
                    <ul>
                        <li>ISO 13053:2011 - M√©todos cuantitativos en mejora de procesos - Six Sigma</li>
                        <li>ASQ (American Society for Quality) - Certificaciones Six Sigma</li>
                        <li>IASSC (International Association for Six Sigma Certification)</li>
                    </ul>
                </div>

                <div style="margin-top: 30px; padding: 20px; background: linear-gradient(135deg, #1a1a2e, #0f0f1a); border-radius: 8px; text-align: center;">
                    <p style="color: var(--accent-primary); font-size: 1.1em; margin: 0;">
                        üìä Esta aplicaci√≥n implementa los principios de SMED y Six Sigma para medir, analizar y mejorar los tiempos de cambio de formato en procesos industriales.
                    </p>
                </div>
            </div>
        </section>

        <!-- ============================================== -->
        <!-- TAB: CONFIGURACI√ìN -->
        <!-- ============================================== -->
        <section id="tab-config" class="view-section">
            <div class="card">
                <h2>Gesti√≥n de Botones</h2>
                
                <!-- Formulario nuevo bot√≥n (categor√≠a autom√°tica de primera palabra) -->
                <form id="addButtonForm" class="form-row mb-15" style="flex-wrap: wrap; gap: 10px;">
                    <div class="form-group" style="flex:2; min-width: 200px;">
                        <label class="form-label">Nombre (primera palabra = categor√≠a)</label>
                        <input type="text" id="newBtnName" class="form-input" placeholder="Ej: Troquel Limpiar" required>
                    </div>
                    <div class="form-group" style="flex:1; min-width: 120px;">
                        <label class="form-label">Tipo SMED</label>
                        <select id="newBtnTipo" class="form-select">
                            <option value="INT" style="color: #f97316;">üü† Interna (m√°q. parada)</option>
                            <option value="EXT" style="color: #10b981;">üü¢ Externa (m√°q. andando)</option>
                            <option value="NVA" style="color: #ef4444;">üî¥ Muda / Desperdicio</option>
                        </select>
                    </div>
                    <div class="form-group" style="flex:0; min-width: 60px;">
                        <label class="form-label">Color</label>
                        <input type="color" id="newBtnColor" value="#3b82f6" style="width: 100%; height: 38px; border: none; cursor: pointer; border-radius: 6px;">
                    </div>
                    <div class="form-group" style="flex:0">
                        <label class="form-label">&nbsp;</label>
                        <button type="submit" class="action-btn primary">+ Crear</button>
                    </div>
                </form>
                <div class="recommendation" style="margin-bottom:15px;">
                    <div class="recommendation-text">
                        üí° <strong>Tipos SMED:</strong> 
                        <span style="color:#f97316;">Interna</span> = con m√°quina parada | 
                        <span style="color:#10b981;">Externa</span> = con m√°quina andando | 
                        <span style="color:#ef4444;">Muda</span> = desperdicio
                    </div>
                </div>

                <!-- Lista de botones configurados -->
                <h2>Botones Configurados</h2>
                <div id="configButtonsList" style="max-height: 250px; overflow-y: auto;"></div>

                <!-- Configuraci√≥n Financiera -->
                <h2 style="margin-top: 20px;">üí∞ Configuraci√≥n Financiera</h2>
                <div style="background: linear-gradient(135deg, #1a1a2e, #0f0f1a); padding: 15px; border-radius: 8px; margin-bottom: 15px; border: 1px solid #f59e0b;">
                    <p style="color: #888; font-size: 0.85em; margin-top: 0;">Estos valores se usan para calcular costos y ahorros potenciales en los an√°lisis.</p>
                    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px;">
                        <div>
                            <label style="font-size: 11px; color: #888; text-transform: uppercase;">Costo por Hora (Q/hora)</label>
                            <input type="number" id="configCostoHora" step="1" min="0" value="500"
                                   style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00ff9d; font-size: 14px; font-weight: bold;"
                                   onchange="AppState.config.costoHora = parseFloat(this.value) || 500; Storage.save();">
                        </div>
                        <div>
                            <label style="font-size: 11px; color: #888; text-transform: uppercase;">Meta Eficiencia (%)</label>
                            <input type="number" id="configMetaEficiencia" step="1" min="50" max="100" value="95"
                                   style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff; font-size: 14px; font-weight: bold;"
                                   onchange="AppState.config.metaEficiencia = parseInt(this.value) || 95; Storage.save();">
                        </div>
                        <div>
                            <label style="font-size: 11px; color: #888; text-transform: uppercase;">Horas por Turno</label>
                            <input type="number" id="configHorasTurno" step="0.5" min="4" max="12" value="8"
                                   style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #8b5cf6; font-size: 14px; font-weight: bold;"
                                   onchange="AppState.config.horasTurno = parseFloat(this.value) || 8; Storage.save();">
                        </div>
                        <div>
                            <label style="font-size: 11px; color: #888; text-transform: uppercase;">Cambios por Turno (meta)</label>
                            <input type="number" id="configCambiosMeta" step="1" min="1" max="50" value="10"
                                   style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #f59e0b; font-size: 14px; font-weight: bold;"
                                   onchange="AppState.config.cambiosMeta = parseInt(this.value) || 10; Storage.save();">
                        </div>
                    </div>
                    <div style="margin-top: 15px; padding: 10px; background: #0a0a0a; border-radius: 4px;">
                        <strong style="color: #f59e0b;">üìä C√°lculo Autom√°tico:</strong>
                        <p style="margin: 5px 0 0 0; color: #aaa; font-size: 0.85em;">
                            Costo por Segundo = Q<span id="calcCostoSeg">0.14</span> | 
                            Tiempo objetivo por cambio = <span id="calcTiempoObjetivo">--</span>
                        </p>
                    </div>
                </div>
                <script>
                    // Actualizar c√°lculos al cargar y al cambiar valores
                    setTimeout(() => {
                        if (AppState.config) {
                            document.getElementById('configCostoHora').value = AppState.config.costoHora || 500;
                            document.getElementById('configMetaEficiencia').value = AppState.config.metaEficiencia || 95;
                            document.getElementById('configHorasTurno').value = AppState.config.horasTurno || 8;
                            document.getElementById('configCambiosMeta').value = AppState.config.cambiosMeta || 10;
                            
                            const costoSeg = ((AppState.config.costoHora || 500) / 3600).toFixed(2);
                            document.getElementById('calcCostoSeg').textContent = costoSeg;
                            
                            const horasTurno = AppState.config.horasTurno || 8;
                            const cambiosMeta = AppState.config.cambiosMeta || 10;
                            const tiempoObjetivo = Math.round((horasTurno * 3600) / cambiosMeta);
                            document.getElementById('calcTiempoObjetivo').textContent = Utils.formatDuration(tiempoObjetivo);
                        }
                    }, 500);
                </script>

                <!-- Gesti√≥n de M√°quinas -->
                <h2 style="margin-top: 20px;">üè≠ Gesti√≥n de M√°quinas</h2>
                <div style="background: #1a1a2e; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <div id="maquinasList" style="display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 15px;"></div>
                    <div style="display: flex; gap: 10px; flex-wrap: wrap; align-items: flex-end;">
                        <div style="flex: 2; min-width: 150px;">
                            <label style="font-size: 10px; color: #888;">Agregar nueva m√°quina:</label>
                            <input type="text" id="newMaquinaName" placeholder="Ej: C1 (Corrugadora)" 
                                   style="width: 100%; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #00d4ff;">
                        </div>
                        <button class="action-btn primary" onclick="MaquinaManager.add(document.getElementById('newMaquinaName').value); document.getElementById('newMaquinaName').value='';" style="padding: 8px 16px;">
                            + Agregar
                        </button>
                        <button class="action-btn" onclick="MaquinaManager.restore()" style="padding: 8px 12px;">
                            üîÑ Restaurar
                        </button>
                    </div>
                </div>
                <script>
                    // Inicializar lista de m√°quinas y selectores
                    setTimeout(() => {
                        if (typeof MaquinaManager !== 'undefined') {
                            MaquinaManager.renderList();
                            MaquinaManager.updateSelectors();
                        }
                    }, 600);
                </script>

                <div class="action-bar" style="flex-wrap: wrap; gap: 10px;">
                    <button class="action-btn" onclick="ButtonManager.restore()">üîÑ Restaurar Botones</button>
                    <button class="action-btn success" onclick="Storage.createBackup(); alert('‚úÖ Backup manual creado');">üíæ Crear Backup</button>
                    <button class="action-btn primary" onclick="Storage.restoreBackup()">üì¶ Restaurar Backup</button>
                    <button class="action-btn danger" onclick="Storage.clearAll()">‚ö†Ô∏è Borrar TODO</button>
                </div>
                
                <!-- Google Drive Sync -->
                <div style="margin-top: 20px; padding: 15px; background: linear-gradient(135deg, #1a237e, #1a1a2e); border-radius: 8px; border: 1px solid #3b82f6;">
                    <h3 style="margin-top:0; color: #4285f4;">‚òÅÔ∏è Google Drive Sync</h3>
                    
                    <div style="display: flex; align-items: center; gap: 15px; flex-wrap: wrap; margin-bottom: 15px;">
                        <div>
                            <span style="color: #888;">Estado:</span>
                            <span id="googleDriveStatus" style="margin-left: 5px; color: #888;">‚ùå No conectado</span>
                        </div>
                        <div>
                            <span style="color: #00ff9d;" id="googleEmail"></span>
                        </div>
                    </div>
                    
                    <!-- Botones Login/Logout -->
                    <button id="googleLoginBtn" class="action-btn primary" onclick="GoogleDrive.signIn()" style="background: #4285f4; font-size: 1em; padding: 10px 20px;">
                        <svg style="width:18px;height:18px;vertical-align:middle;margin-right:8px;" viewBox="0 0 24 24">
                            <path fill="#fff" d="M12.545,10.239v3.821h5.445c-0.712,2.315-2.647,3.972-5.445,3.972c-3.332,0-6.033-2.701-6.033-6.032s2.701-6.032,6.033-6.032c1.498,0,2.866,0.549,3.921,1.453l2.814-2.814C17.503,2.988,15.139,2,12.545,2C7.021,2,2.543,6.477,2.543,12s4.478,10,10.002,10c8.396,0,10.249-7.85,9.426-11.748L12.545,10.239z"/>
                        </svg>
                        Conectar con Google
                    </button>
                    <button id="googleLogoutBtn" class="action-btn" onclick="GoogleDrive.signOut()" style="display: none; background: #666;">
                        üö™ Cerrar Sesi√≥n
                    </button>
                    
                    <!-- Botones de Sincronizaci√≥n (visibles cuando est√° conectado) -->
                    <div id="googleSyncBtns" style="display: none; gap: 10px; flex-wrap: wrap; margin-top: 15px;">
                        <button class="action-btn" onclick="GoogleDrive.forceSync()" style="background: #6366f1;">
                            üîÑ Sincronizar Ahora
                        </button>
                        <button class="action-btn success" onclick="GoogleDrive.saveBackup()">
                            ‚òÅÔ∏è Subir a Drive
                        </button>
                        <button class="action-btn primary" onclick="GoogleDrive.loadBackup()">
                            üì• Descargar/Fusionar
                        </button>
                    </div>
                    
                    <!-- Info de √∫ltima sincronizaci√≥n -->
                    <div style="margin-top: 15px; font-size: 0.85em; color: #888;">
                        <span>√öltima sincronizaci√≥n:</span>
                        <span id="lastSyncTime" style="color: #00ff9d;">--</span>
                    </div>
                    
                    <!-- Compartir con otros usuarios -->
                    <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #333;">
                        <h4 style="margin: 0 0 10px; color: #f59e0b;">üë• Compartir con el Equipo</h4>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <input type="email" id="shareEmailInput" placeholder="correo@ejemplo.com" 
                                   style="flex: 2; min-width: 200px; padding: 8px; border-radius: 4px; border: 1px solid #444; background: #0a0a0a; color: #fff;">
                            <button class="action-btn" onclick="GoogleDrive.shareWith(document.getElementById('shareEmailInput').value); document.getElementById('shareEmailInput').value='';">
                                üì§ Compartir
                            </button>
                        </div>
                        <p style="margin: 10px 0 0; font-size: 0.8em; color: #666;">
                            La persona recibir√° acceso a la carpeta SMED_Analyzer_Pro en tu Drive.
                        </p>
                    </div>
                    
                    <div style="margin-top: 15px; padding: 10px; background: #0a0a0a; border-radius: 4px; font-size: 0.85em; color: #888;">
                        <strong>üîÑ Sincronizaci√≥n autom√°tica:</strong> Cada 5 minutos (cuando est√°s conectado)
                    </div>
                </div>

                <!-- Info del Backup Local -->
                <div id="backupInfo" style="margin-top: 15px; padding: 15px; background: #1a1a2e; border-radius: 8px; border: 1px solid #333;">
                    <h3 style="margin-top:0; color: #00d4ff;">üì¶ Backup Local</h3>
                    <p style="color: #888; font-size: 0.9em;">
                        ‚úì Backup autom√°tico diario<br>
                        ‚úì Backup al cerrar la app<br>
                        ‚úì Backup antes de borrar datos<br>
                        ‚úì Los botones personalizados NO se borran con "Reset"
                    </p>
                    <p style="color: #00ff9d; font-size: 0.85em;" id="backupStatus">
                        Cargando info de backup...
                    </p>
                </div>
                
                <script>
                    // Mostrar info del backup al cargar
                    setTimeout(() => {
                        const info = Storage.getBackupInfo();
                        const el = document.getElementById('backupStatus');
                        if (el && info) {
                            const fecha = new Date(info.fecha).toLocaleString();
                            el.innerHTML = `üìÖ √öltimo backup: <strong>${fecha}</strong><br>üìä ${info.registros} registros | üîò ${info.buttons} botones`;
                        } else if (el) {
                            el.innerHTML = '‚ö†Ô∏è No hay backup guardado a√∫n';
                        }
                    }, 500);
                </script>

                <!-- Secci√≥n Teor√≠a SMED -->
                <div class="theory-section">
                    <div class="theory-header" onclick="Theory.toggle()">
                        <span class="theory-title">üìö Teor√≠a SMED / Lean / Six Sigma</span>
                        <span class="theory-toggle" id="theoryToggle">+</span>
                    </div>
                    <div class="theory-content" id="theoryContent">
                        <h4>¬øQu√© es SMED?</h4>
                        <p><strong>SMED</strong> (Single-Minute Exchange of Die) es una metodolog√≠a desarrollada por <strong>Shigeo Shingo</strong> para Toyota que busca reducir los tiempos de cambio de formato a menos de 10 minutos (un solo d√≠gito de minutos).</p>
                        
                        <h4>Las 4 Etapas SMED</h4>
                        <table class="theory-table">
                            <tr>
                                <th>Etapa</th>
                                <th>Descripci√≥n</th>
                                <th>Reducci√≥n</th>
                            </tr>
                            <tr>
                                <td>0. Inicial</td>
                                <td>Observar y documentar el proceso actual</td>
                                <td>Base</td>
                            </tr>
                            <tr>
                                <td>1. Separar</td>
                                <td>Distinguir actividades internas de externas</td>
                                <td>30-50%</td>
                            </tr>
                            <tr>
                                <td>2. Convertir</td>
                                <td>Transformar internas en externas</td>
                                <td>25-50%</td>
                            </tr>
                            <tr>
                                <td>3. Optimizar</td>
                                <td>Mejorar todas las operaciones restantes</td>
                                <td>25-50%</td>
                            </tr>
                        </table>

                        <h4>Los 8 Desperdicios (MUDA)</h4>
                        <ul>
                            <li><strong>Sobreproducci√≥n:</strong> Producir m√°s de lo necesario</li>
                            <li><strong>Espera:</strong> Tiempos muertos</li>
                            <li><strong>Transporte:</strong> Mover materiales innecesariamente</li>
                            <li><strong>Sobreprocesamiento:</strong> Trabajo innecesario</li>
                            <li><strong>Inventario:</strong> Stock excesivo</li>
                            <li><strong>Movimiento:</strong> Desplazamientos innecesarios</li>
                            <li><strong>Defectos:</strong> Errores y retrabajos</li>
                            <li><strong>Talento:</strong> No utilizar las ideas del equipo</li>
                        </ul>

                        <h4>DMAIC de Six Sigma</h4>
                        <table class="theory-table">
                            <tr>
                                <th>Fase</th>
                                <th>Significado</th>
                                <th>Objetivo</th>
                            </tr>
                            <tr>
                                <td>D</td>
                                <td>Define (Definir)</td>
                                <td>Identificar el problema</td>
                            </tr>
                            <tr>
                                <td>M</td>
                                <td>Measure (Medir)</td>
                                <td>Recopilar datos del proceso</td>
                            </tr>
                            <tr>
                                <td>A</td>
                                <td>Analyze (Analizar)</td>
                                <td>Identificar causas ra√≠z</td>
                            </tr>
                            <tr>
                                <td>I</td>
                                <td>Improve (Mejorar)</td>
                                <td>Implementar soluciones</td>
                            </tr>
                            <tr>
                                <td>C</td>
                                <td>Control (Controlar)</td>
                                <td>Mantener las mejoras</td>
                            </tr>
                        </table>

                        <h4>Niveles de Certificaci√≥n Six Sigma</h4>
                        <table class="theory-table">
                            <tr>
                                <th>Belt</th>
                                <th>Rol</th>
                                <th>Conocimiento</th>
                            </tr>
                            <tr>
                                <td>‚ö™ White Belt</td>
                                <td>Equipo de apoyo</td>
                                <td>Conceptos b√°sicos</td>
                            </tr>
                            <tr>
                                <td>üü° Yellow Belt</td>
                                <td>Participante de proyecto</td>
                                <td>Herramientas b√°sicas</td>
                            </tr>
                            <tr>
                                <td>üü¢ Green Belt</td>
                                <td>L√≠der de proyecto</td>
                                <td>Metodolog√≠a completa</td>
                            </tr>
                            <tr>
                                <td>‚ö´ Black Belt</td>
                                <td>Experto/Mentor</td>
                                <td>Estad√≠stica avanzada</td>
                            </tr>
                            <tr>
                                <td>‚ö´‚ö´ Master Black Belt</td>
                                <td>Estratega</td>
                                <td>Transformaci√≥n organizacional</td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Scripts -->
    <script src="js/app.js"></script>
    <script src="js/statistics.js"></script>
    <script src="js/charts.js"></script>
    <script src="js/gantt.js"></script>
    <script src="js/reports.js"></script>
    <script src="js/googleDrive.js"></script>
    
    <!-- Cargar configuraci√≥n de informes -->
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            setTimeout(() => {
                if (typeof Reports !== 'undefined') {
                    Reports.loadConfig();
                }
            }, 300);
        });
    </script>
    
    <!-- Registro del Service Worker para PWA -->
    <script>
        // Registrar Service Worker para funcionalidad offline e instalaci√≥n
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('‚úÖ Service Worker registrado:', reg.scope))
                    .catch(err => console.log('‚ùå Service Worker error:', err));
            });
        }
        
        // Detectar evento de instalaci√≥n PWA
        let deferredPrompt;
        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            console.log('üì± App lista para instalar');
        });
    </script>
</body>
</html>
